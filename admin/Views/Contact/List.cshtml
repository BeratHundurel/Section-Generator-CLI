@model AdminPageViewModel
@inject IUnitOfWork _uow

@{
    ViewData["Title"] = "Mesaj Listesi";
    var items = Model.Contacts;
}

@section libScript{
    <!--Data Tables js-->
    <script src="~/theme/assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
    <script src="~/js/my_lib/list_data_table.js"></script>
}
@section libStyle{
    <!--Data Tables -->
    <link href="~/theme/assets/plugins/datatable/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css">
    <link href="~/theme/assets/plugins/datatable/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css">
}

@await Component.InvokeAsync("Breadcrumb", new BreadcrumbViewModel { Title = "Mesaj Listesi" })

<div class="card">
    <div class="card-body">
        <div class="card-title">
            <h4 class="mb-0">Mesajlar</h4>
        </div>
        <hr />
        <form asp-action="list" method="get">
            <div class="row mb-3">
                <div class="col-lg-4">
                    <input type="text" class="form-control" asp-for="f.q" placeholder="Arama yap" />
                </div>
                <div class="col-lg-3">
                    <select asp-for="f.pageSize" class="form-control">
                        <option value="">Tek seferde bu kadar göster..</option>
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="250">250</option>
                        <option value="500">500</option>
                        <option value="1000">1000</option>
                        <option value="2000">2000</option>
                        <option value="5000">5000</option>
                    </select>
                </div>
                <div class="col-lg-2">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" asp-for="f.r1" value="@null" />
                        <label class="form-check-label" asp-for="f.r1">
                            Tümü
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" asp-for="f.r1" value="@Convert.ToBoolean(true)" />
                        <label class="form-check-label" asp-for="f.r1">
                            Okunanlar
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" asp-for="f.r1" value="@Convert.ToBoolean(false)" />
                        <label class="form-check-label" asp-for="f.r1">
                            Okunmayanlar
                        </label>
                    </div>
                </div>
                <div class="col-lg-3">
                    <input type="submit" class="btn btn-info" value="Filtrele" />
                    <a asp-action="list" class="btn btn-outline-info">Sıfırla</a>
                </div>
            </div>
        </form>
        <table class="table table-striped table-hover" id="dataTable">
            <thead>
                <tr>
                    <th> Ad Soyad </th>
                    <th> Soyad </th>
                    <th> E-Posta </th>
                    @*<th> Şirket </th>*@
                    <th> Cep Telefonu </th>
                    @*<th> Konu </th>*@
                    <th> Gönderim Tarihi </th>
                    <th> Gönderim IP </th>
                    <th class="noExport"> İşlemler </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in items)
                {
                    <tr>
                        <td> @item.Name </td>
                        <td> @item.Surname  </td>
                        <td> @item.Email </td>
                        @*<td> @item.Company </td>*@
                        <td> @item.Phone </td>
                        @*<td> @item.Subject </td>*@
                        <td> @item.CreatedDate </td>
                        <td> @item.CreatedIp </td>
                        <td>
                            @await Component.InvokeAsync("Link", new { viewName = "Default", vm = new LinkViewModel { Title = "Oku", ClassName = "btn btn-info btn-sm", Href = "/admin/contact/read?id=" + item.Id } })
                            @await Component.InvokeAsync("Link", new { viewName = "Delete", vm = new LinkViewModel { Title = "Sil", ClassName = "btn btn-danger btn-sm", DataId = item.Id, DataUrl = "/admin/contact/delete" } })
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        <div class="pagination-button">
            @{
                var prevDisabled = !items.PreviousPage ? "disabled" : "";
                var nextDisabled = !items.NextPage ? "disabled" : "";
            }
            <form method="get">
                <input type="hidden" name="f.q" value="@Model.f.q" />
                <input type="hidden" name="f.q2" value="@Model.f.q2" />
                <input type="hidden" name="f.userId" value="@Model.f.userId" />
                <input type="hidden" name="f.pageSize" value="@Model.f.pageSize" />
                <input type="hidden" name="f.pageNumber" value="@(items.PageIndex - 1)" />
                <button type="submit" class="btn btn-secondary @prevDisabled">Geri</button>
            </form>
            <form method="get">
                <input type="hidden" name="f.q" value="@Model.f.q" />
                <input type="hidden" name="f.q2" value="@Model.f.q2" />
                <input type="hidden" name="f.userId" value="@Model.f.userId" />
                <input type="hidden" name="f.pageSize" value="@Model.f.pageSize" />
                <input type="hidden" name="f.pageNumber" value="@(items.PageIndex + 1)" />
                <button type="submit" class="ml-1 btn btn-secondary @nextDisabled">İleri</button>
            </form>
        </div>
    </div>
</div>